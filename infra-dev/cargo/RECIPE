PKG=cargo
VER=0.21.0
SRC=$PKG-$VER.tar.gz::https://github.com/rust-lang/$PKG/archive/$VER.tar.gz

build() {
    export CARGO_HOME="$SRC_DIR/.cargo"

    rm Cargo.lock # unlock rust-openssl 0.9.4

    cargo build --release
    cargo install --root $PKG_DIR

    rm $PKG_DIR/.crates.toml

    install -Dm644 src/etc/cargo.bashcomp.sh \
        $DAT_DIR/bash-completion/completions/cargo

    install -d $DAT_DIR/man/man1/
    for f in src/etc/man/*; do
        cp "$f" $DAT_DIR/man/man1/
    done
}
